{"version":3,"file":"logger.js","names":["winston","ElasticsearchTransformer","ElasticsearchTransport","esTransformer","logData","winstonLogger","elasticsearchNode","name","level","options","console","handleExceptions","json","colorize","elasticsearch","transformer","clientOpts","node","log","maxRetries","requestTimeout","sniffOnStart","esTransport","logger","createLogger","exitOnError","defaultMeta","service","transports","Console"],"sources":["../../src/logger.ts"],"sourcesContent":["import winston, { Logger } from 'winston';\r\nimport { ElasticsearchTransformer, ElasticsearchTransport, LogData, TransformedData } from 'winston-elasticsearch';\r\n\r\nconst esTransformer = (logData: LogData): TransformedData => {\r\n  return ElasticsearchTransformer(logData);\r\n}\r\n\r\nexport const winstonLogger = (elasticsearchNode: string, name: string, level: string): Logger => {\r\n  const options = {\r\n    console: {\r\n      level,\r\n      handleExceptions: true,\r\n      json: false,\r\n      colorize: true\r\n    },\r\n    elasticsearch: {\r\n      level,\r\n      transformer: esTransformer,\r\n      clientOpts: {\r\n        node: elasticsearchNode,\r\n        log: level,\r\n        maxRetries: 2,\r\n        requestTimeout: 10000,\r\n        sniffOnStart: false\r\n      }\r\n    }\r\n  };\r\n  const esTransport: ElasticsearchTransport = new ElasticsearchTransport(options.elasticsearch);\r\n  const logger: Logger = winston.createLogger({\r\n    exitOnError: false,\r\n    defaultMeta: { service: name },\r\n    transports: [new winston.transports.Console(options.console), esTransport]\r\n  });\r\n  return logger;\r\n}\r\n"],"mappings":"AAAA,OAAOA,OAAO,MAAkB,SAAS;AACzC,SAASC,wBAAwB,EAAEC,sBAAsB,QAAkC,uBAAuB;AAElH,MAAMC,aAAa,GAAIC,OAAgB,IAAsB;EAC3D,OAAOH,wBAAwB,CAACG,OAAO,CAAC;AAC1C,CAAC;AAED,OAAO,MAAMC,aAAa,GAAGA,CAACC,iBAAyB,EAAEC,IAAY,EAAEC,KAAa,KAAa;EAC/F,MAAMC,OAAO,GAAG;IACdC,OAAO,EAAE;MACPF,KAAK;MACLG,gBAAgB,EAAE,IAAI;MACtBC,IAAI,EAAE,KAAK;MACXC,QAAQ,EAAE;IACZ,CAAC;IACDC,aAAa,EAAE;MACbN,KAAK;MACLO,WAAW,EAAEZ,aAAa;MAC1Ba,UAAU,EAAE;QACVC,IAAI,EAAEX,iBAAiB;QACvBY,GAAG,EAAEV,KAAK;QACVW,UAAU,EAAE,CAAC;QACbC,cAAc,EAAE,KAAK;QACrBC,YAAY,EAAE;MAChB;IACF;EACF,CAAC;EACD,MAAMC,WAAmC,GAAG,IAAIpB,sBAAsB,CAACO,OAAO,CAACK,aAAa,CAAC;EAC7F,MAAMS,MAAc,GAAGvB,OAAO,CAACwB,YAAY,CAAC;IAC1CC,WAAW,EAAE,KAAK;IAClBC,WAAW,EAAE;MAAEC,OAAO,EAAEpB;IAAK,CAAC;IAC9BqB,UAAU,EAAE,CAAC,IAAI5B,OAAO,CAAC4B,UAAU,CAACC,OAAO,CAACpB,OAAO,CAACC,OAAO,CAAC,EAAEY,WAAW;EAC3E,CAAC,CAAC;EACF,OAAOC,MAAM;AACf,CAAC","ignoreList":[]}